class Solution {
    public Node copyRandomList(Node head) {
        Node dummy = new Node(-1);
        Node ans = dummy;
        Map<Node, Node> map = new HashMap<>();
        Node head_bkp = head;
        while(head != null) {
            Node current = new Node(head.val); 
            map.put(head, current);
            ans.next = current;
            ans = ans.next;
            head = head.next;
        }

        head = head_bkp;
        while(head != null) {
            map.get(head).random = map.get(head.random);
            head = head.next;
        }
        return dummy.next;

    }
}
